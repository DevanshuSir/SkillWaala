<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Admin Dashboard</title>
    <!-- Bootstrap & Icons -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css"
    />
    <link rel="stylesheet" href="./css/adminaitool.css" />

    <style>



    
      .modal-content {
        border-radius: 16px;
        overflow: hidden;
        animation: scaleIn 0.25s ease-in-out;
      }

      @keyframes scaleIn {
        0% {
          transform: scale(0.9);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }

      .modal-header .bg-danger {
        background: linear-gradient(135deg, #ff3b3b, #b30000);
      }
      .modal-body {
        font-size: 16px;
        text-align: left;
        color: #323233;
      }
      .modal-body i {
        font-size: 32px;
        color: #ff3b3b;
        margin-bottom: 8px;
      }

      .notification-bell {
        position: relative;
        font-size: 28px;
        cursor: pointer;
      }

      .notification-badge {
        position: absolute;
        top: -6px;
        right: -6px;
        background: red;
        color: white;
        border-radius: 50%;
        padding: 2px 6px;
        font-size: 12px;
        min-width: 18px;
        text-align: center;
      }

      .notification .dropdown-menu {
        width: 300px;
        padding: 0;
        overflow: hidden;
      }

      .notification-header {
        background-color: #0d6efd;
        color: white;
        padding: 10px;
        font-weight: 500;
      }

      .notification .dropdown-item {
        white-space: normal;
        font-size: 14px;
      }

      .notification a {
        text-decoration: none;
      }

      .no-notifications {
        color: gray;
        text-align: center;
        padding: 10px;
        font-style: italic;
      }

      .clear-all-btn {
        display: block;
        width: 100%;
        border: none;
        background: #f1f1f1;
        color: #0d6efd;
        padding: 8px 0;
        text-align: center;
        font-weight: 500;
        cursor: pointer;
        border-top: 1px solid #ddd;
      }

      .clear-all-btn:hover {
        background-color: #e9ecef;
      }

      .btn-orange {
        background: #f97316;
        color: #fff;
      }
      .btn-orange:hover {
        background: #ea580c;
        color: #fff;
      }
       .card {
        border-radius: 10px;
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
        border: none;
        background: #fff;
      }
      .btn-orange {
        background: #f97316;
        color: #fff;
      }
      .btn-orange:hover {
        background: #ea580c;
        color: #fff;
      }
      .small-muted {
        font-size: 0.85rem;
        color: #6b7280;
      }
      .img-thumb {
        width: 55px;
        height: 55px;
        object-fit: cover;
        border-radius: 8px;
      }
     
      .star-widget {
        display: inline-flex;
        align-items: center;
        gap: 6px;
      }
      .star-widget .star {
        font-size: 20px;
        cursor: pointer;
        color: #ddd;
        transition:
          color 0.12s ease,
          transform 0.08s ease;
      }
      .star-widget .star:hover {
        transform: scale(1.08);
      }
      .star-widget .star.filled {
        color: #ffd700;
      } /* golden */
      .compare-row {
        border: 1px solid #e9ecef;
        padding: 12px;
        border-radius: 8px;
        margin-bottom: 10px;
        background: #fff;
      }
      .suggestions {
        position: absolute;
        z-index: 60;
        width: 100%;
        background: #fff;
        border: 1px solid #ddd;
        max-height: 160px;
        overflow: auto;
        border-radius: 6px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.06);
      }
      .suggestions li {
        padding: 8px 10px;
        cursor: pointer;
      }
      .suggestions li:hover {
        background: #f1f5f9;
      }
      .datalist-hidden {
        display: none;
      }
    </style>
  </head>

  <body>
    <!-- âœ… SIDEBAR -->
    <div class="sidebar">
      <div class="brand">
        <i class="fa-solid fa-user"></i>
        <span>Admin</span>
      </div>
      <nav class="nav flex-column">
        <a class="nav-link active" href="./admin.html" data-title="Dashboard">
          <i class="fa-solid fa-gauge me-1"></i> <span>Dashboard</span>
        </a>
          <a
          class="nav-link"
          href="./admintotalcourse.html"
          data-title="Total Courses"
        >
          <i class="fa-solid fa-book-medical me-1"></i>
          <span>Total Courses</span>
        </a>
        <a
          class="nav-link"
          href="./admintotalstudents.html"
          data-title="Total Student Enroll"
        >
          <i class="fa-solid fa-user-check me-1"></i>
          <span>Total Student Enroll</span>
        </a>
        <a
          class="nav-link"
          href="./adminbatchcount.html"
          data-title="Active Courses Count"
        >
          <i class="fa-solid fa-book me-1"></i><span>Active Courses Count</span>
        </a>
        <a
          class="nav-link"
          href="./adminnotification.html"
          data-title="All Community Quarry"
        >
          <i class="fa-solid fa-comments me-1"></i
          ><span>All Community Quarry</span>
        </a>
        <a
          class="nav-link"
          href="./admintrainermanage.html"
          data-title="Trainer Dashboard"
        >
          <i class="fa-solid fa-users me-1"></i><span>Trainer Dashboard</span>
        </a>

        <a
          class="nav-link"
          href="./adminhiringportal.html"
          data-title="Hiring Portal"
        >
          <i class="fa-solid fa-arrows-down-to-people me-1"></i
          ><span>Hiring Portal</span>
        </a>

        <a class="nav-link" href="./index.html" data-title="Logout">
          <i class="fa-solid fa-right-from-bracket me-1"></i><span>Logout</span>
        </a>
      </nav>
    </div>

    <!-- âœ… NAVBAR -->
    <nav class="navbar navbar-expand-lg">
      <div class="container-fluid">
        <button class="sidebar-toggle-btn">
          <i class="fa-solid fa-bars"></i>
        </button>

        <img
          src="./media/ok quality logo.png"
          alt="Logo"
          width="130"
          class="navbar-brand fw-bold mx-auto"
        />
      </div>
    </nav>

    <!-- âœ… Main Content -->
    <main class="main">
      <div class="container-fluid p-3 p-md-4">
        <div class="topbar">
          <h6 class="mb-0 text-muted">Home / AI Tools</h6>
          <div class="d-flex align-items-center gap-2 flex-wrap">
            <div class="d-flex justify-content-end">
              <div class="dropdown notification">
                <div
                  id="bell"
                  class="notification-bell"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  ðŸ””
                  <span id="badge" class="notification-badge">3</span>
                </div>

                <ul
                  id="notificationList"
                  class="dropdown-menu dropdown-menu-end"
                  aria-labelledby="bell"
                >
                  <li class="notification-header">Notifications</li>
                  <a href="./adminnotification.html">
                    <li class="dropdown-item">ðŸ“© You have a new message</li>
                  </a>
                  <a href="./adminnotification.html">
                    <li class="dropdown-item">ðŸ“¦ New community message</li>
                  </a>
                  <a href="./adminnotification.html">
                    <li class="dropdown-item">ðŸ’¬ New comment on your post</li>
                  </a>

                  <li>
                    <button id="clearAll" class="clear-all-btn">
                      Clear All
                    </button>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <div class="profile-hero mt-3">
          <div class="profile-left">
            <img
              src="https://img.freepik.com/free-vector/isolated-young-handsome-man-different-poses-white-background-illustration_632498-859.jpg?semt=ais_hybrid&w=740&q=80"
              class="profile-avatar"
            />
            <div>
              <h6 class="mb-0 fs-2">Admin</h6>
            </div>
          </div>
        </div>

        <div class="container mt-3">
          <h3 class="text-center mb-4 fw-bold">AI Tools Admin Panel</h3>

          <!-- step controls -->
          <div class="mb-3 d-flex justify-content-between align-items-center">
            <div>
              <span class="badge bg-primary"
                >Step <span id="currentStep">1</span></span
              >
              <strong id="stepTitle" class="ms-2">Manage Categories</strong>
            </div>
            <div>
              <button id="goCat" class="btn btn-outline-secondary btn-sm me-1">
                Categories
              </button>
              <button
                id="goTools"
                class="btn btn-outline-secondary btn-sm me-1"
              >
                Tools
              </button>
              <button id="goDetails" class="btn btn-outline-secondary btn-sm">
                Details
              </button>
            </div>
          </div>

          <!-- STEP 1: Categories -->
          <section id="step1" class="step-section active">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h5 class="mb-0">Step 1 â€” Categories</h5>
              <button
                class="btn btn-orange btn-sm"
                data-bs-toggle="modal"
                data-bs-target="#categoryModal"
              >
                <i class="bi bi-plus-lg"></i> Add Category
              </button>
            </div>
            <div class="row" id="categoryGrid"></div>
          </section>

          <!-- STEP 2: Tools -->
          <section id="step2" class="step-section" style="display: none">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <div>
                <button
                  id="backToCat"
                  class="btn btn-outline-secondary btn-sm me-2"
                >
                  <i class="bi bi-arrow-left"></i> Back
                </button>
                <h5 class="d-inline">
                  Step 2 â€” Tools in
                  <span id="catTitle" class="text-primary"></span>
                </h5>
              </div>
              <div>
                <button
                  class="btn btn-orange btn-sm"
                  data-bs-toggle="modal"
                  data-bs-target="#toolModal"
                >
                  <i class="bi bi-plus-lg"></i> Add Tool
                </button>
              </div>
            </div>

            <div class="table-responsive card p-3">
              <table class="table table-hover align-middle mb-0">
                <thead class="table-light">
                  <tr>
                    <th>#</th>
                    <th>Image</th>
                    <th>Name</th>
                    <th>Category</th>
                    <th>Pricing</th>
                    <th>Platform</th>
                    <th>Website</th>
                    <th>YouTube</th>
                    <th>Instagram</th>
                    <th>Facebook</th>
                    <th>Rating</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="toolsTable"></tbody>
              </table>
            </div>
          </section>

          <!-- STEP 3: Details -->
          <section id="step3" class="step-section" style="display: none">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <div>
                <button
                  id="backToTools"
                  class="btn btn-outline-secondary btn-sm me-2 mb-3"
                >
                  <i class="bi bi-arrow-left"></i> Back
                </button>
                <h5 class="mb-0">Step 3 â€” Tool Details</h5>
              </div>
              <div>
                <button id="saveDetailsBtn" class="btn btn-orange btn-sm">
                  Save Details
                </button>
              </div>
            </div>

            <div class="card p-3">
              <form id="detailForm" class="row g-3">
                <div class="col-md-6">
                  <label class="form-label">Tool Name</label>
                  <input id="dName" class="form-control" readonly />
                </div>

                <div class="col-md-6">
                  <label class="form-label">Subtitle / Tagline</label>
                  <input id="dTag" class="form-control" />
                </div>

                <div class="col-md-4">
                  <label class="form-label d-block">Rating</label>
                  <!-- hidden input keeps numeric rating value -->
                  <input type="hidden" id="dRating" value="0" />
                  <div
                    id="dRatingStars"
                    class="star-widget"
                    aria-label="Tool rating"
                  ></div>
                </div>

                <div class="col-md-4">
                  <label class="form-label">Category</label>
                  <input id="dCategory" class="form-control" readonly />
                </div>

                <div class="col-md-4">
                  <label class="form-label">Pricing</label>
                  <select id="dPricing" class="form-select">
                    <option>Free</option>
                    <option>Paid</option>
                    <option>Free + Paid</option>
                  </select>
                </div>

                <!-- Attributes -->
                <!-- <div class="col-12">
                  <h6 class="mt-2">Attributes</h6>
                  <div class="row g-2">
                    <div class="col-md-3">
                      <label class="form-label">Platform</label>
                      <select id="attrPlatform" class="form-select">
                        <option>Web</option>
                        <option>App</option>
                        <option>Web + App</option>
                      </select>
                    </div>
                    <div class="col-md-3">
                      <label class="form-label">API (Yes/No)</label>
                      <select id="attrApi" class="form-select">
                        <option value="">--Select--</option>
                        <option>Yes</option>
                        <option>No</option>
                      </select>
                    </div>
                    <div class="col-md-3">
                      <label class="form-label">Best For</label>
                      <select id="attrBestFor" class="form-select">
                        <option>Creators</option>
                        <option>Designer</option>
                        <option>Developer</option>
                      </select>
                    </div>
                    <div class="col-md-3">
                      <label class="form-label">Pricing</label>
                      <select id="attrImageGen" class="form-select">
                        <option>Free</option>
                        <option>Paid</option>
                        <option>Free+Paid</option>
                      </select>
                    </div>
                  </div>
                </div> -->

                <div class="col-12">
  <h6 class="mt-2 d-flex justify-content-between align-items-center">
    <span>Attributes</span>
    <button id="addAttrBtn" class="btn btn-outline-secondary btn-sm">
      <i class="bi bi-plus-lg"></i> Add Attribute
    </button>
  </h6>
  <div id="attrContainer" class="row g-2"></div>
</div>

                <!-- Compare With (dynamic rows) -->
                <div class="col-12">
                  <h6 class="mt-3">Compare With (Add multiple tools)</h6>
                  <div id="compareContainer"></div>
                  <div class="mt-2">
                    <button
                      id="addCompareBtn"
                      class="btn btn-outline-secondary btn-sm"
                    >
                      <i class="bi bi-plus-lg"></i> Add Tool to Compare
                    </button>
                  </div>
                </div>

                <div class="col-12 mt-2">
                  <label class="form-label">Key Features</label>
                  <textarea
                    id="dFeatures"
                    class="form-control"
                    rows="3"
                    placeholder="Comma-separated or newline"
                  ></textarea>
                </div>

                <div class="col-12">
                  <label class="form-label">Detailed Analysis</label>
                  <textarea
                    id="dAnalysis"
                    class="form-control"
                    rows="4"
                  ></textarea>
                </div>

                <div class="col-md-6">
                  <label class="form-label">Pros (one per line)</label>
                  <textarea id="dPros" class="form-control" rows="3"></textarea>
                </div>

                <div class="col-md-6">
                  <label class="form-label">Cons (one per line)</label>
                  <textarea id="dCons" class="form-control" rows="3"></textarea>
                </div>

                <!-- FAQs -->
                <div class="col-12">
                  <h6>FAQs</h6>
                  <div class="row g-2">
                    <div class="col-md-5">
                      <input
                        id="faqQ"
                        class="form-control"
                        placeholder="Question"
                      />
                    </div>
                    <div class="col-md-5">
                      <input
                        id="faqA"
                        class="form-control"
                        placeholder="Answer"
                      />
                    </div>
                    <div class="col-md-2">
                      <button id="addFaqBtn" class="btn btn-orange w-100">
                        <i class="bi bi-plus-lg"></i>
                      </button>
                    </div>
                  </div>
                  <ul id="faqList" class="list-group mt-2"></ul>
                </div>

                <!-- Related Tools with autosuggest -->
                <div class="col-12">
                  <h6>Related Tools</h6>
                  <div class="position-relative">
                    <input
                      id="relatedInput"
                      class="form-control"
                      placeholder="Type to search tools..."
                      autocomplete="off"
                    />
                    <ul
                      id="relatedSuggestions"
                      class="suggestions"
                      style="display: none"
                    ></ul>
                  </div>
                  <div class="mt-2">
                    <button
                      id="addRelatedBtn"
                      class="btn btn-outline-secondary"
                    >
                      Add
                    </button>
                  </div>
                  <ul id="relatedList" class="list-group mt-2"></ul>
                </div>
              </form>
            </div>
          </section>
        </div>
        <!-- container -->

        <!-- Category Modal -->
        <div class="modal fade" id="categoryModal" tabindex="-1">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Add Category</h5>
                <button class="btn-close" data-bs-dismiss="modal"></button>
              </div>
              <div class="modal-body">
                <input
                  id="catInput"
                  class="form-control"
                  placeholder="Category Name"
                />
              </div>
              <div class="modal-footer">
                <button class="btn btn-secondary" data-bs-dismiss="modal">
                  Cancel</button
                ><button id="saveCategory" class="btn btn-orange">Save</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Tool Modal (quick add/quick edit) -->
        <div class="modal fade" id="toolModal" tabindex="-1">
          <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Add / Quick Edit Tool</h5>
                <button class="btn-close" data-bs-dismiss="modal"></button>
              </div>
              <div class="modal-body">
                <form id="toolForm" class="row g-3">
                  <div class="col-md-6">
                    <label class="form-label">Tool Name</label
                    ><input id="tName" class="form-control" required />
                  </div>
                  <div class="col-md-6">
                    <label class="form-label">Category</label
                    ><input id="tCategory" class="form-control" readonly />
                  </div>

                  <div class="col-md-4">
                    <label class="form-label">Pricing</label
                    ><select id="tPricing" class="form-select">
                      <option>Free</option>
                      <option>Paid</option>
                      <option>Free + Paid</option>
                    </select>
                  </div>
                  <div class="col-md-4">
                    <label class="form-label">Platform</label
                    ><input id="tPlatform" class="form-control" />
                  </div>

                  <div class="col-md-4 ">
                    <label class="form-label d-block" >Rating</label>
                    <input type="hidden" id="tRating" value="0" />
                    <div id="tRatingStars" class="star-widget"></div>
                  </div>

                  <div class="col-md-6">
                    <label class="form-label">Website URL</label
                    ><input id="tWebsite" type="url" class="form-control" />
                  </div>
                  <div class="col-md-6">
                    <label class="form-label">YouTube URL</label
                    ><input id="tYouTube" type="url" class="form-control" />
                  </div>
                  <div class="col-md-6">
                    <label class="form-label">Instagram URL</label
                    ><input id="tInsta" type="url" class="form-control" />
                  </div>
                  <div class="col-md-6">
                    <label class="form-label">Facebook URL</label
                    ><input id="tFacebook" type="url" class="form-control" />
                  </div>

                  <div class="col-md-6">
                    <label for="">Tool Image</label>
                    <input type="file" name="" id="" class="form-control" />
                  </div>

                  <!-- optional image upload placeholder (if you added earlier) -->
                </form>
              </div>
              <div class="modal-footer">
                <button class="btn btn-secondary" data-bs-dismiss="modal">
                  Cancel</button
                ><button id="saveTool" class="btn btn-orange">Save Tool</button>
              </div>
            </div>
          </div>
        </div>

      <!-- Footer -->
      <footer>
        <!-- Bottom Copyright -->
        <div class="footer-bottom">
          <p>Copyright Â©2027 SkillWaala. All Rights Reserved.</p>
        </div>

        <div class="footer-contacts">
          <p>Business No: +91 7766967799</p>
          <p>Email: hro@skillwaala.com</p>
        </div>
      </footer>

   
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      const sidebar = document.querySelector(".sidebar");
      const toggleBtn = document.querySelector(".sidebar-toggle-btn");
      const navLinks = document.querySelectorAll(".sidebar .nav-link");

      // Sidebar toggle for desktop + mobile
      toggleBtn.addEventListener("click", () => {
        if (window.innerWidth < 992) {
          sidebar.classList.toggle("show");
        } else {
          sidebar.classList.toggle("collapsed");
        }
      });

      // âœ… Auto set active link based on URL
      const currentLocation = window.location.href;
      navLinks.forEach((link) => {
        if (link.href === currentLocation) {
          link.classList.add("active");
        } else {
          link.classList.remove("active");
        }
      });
    </script>

    <script>
      const badge = document.getElementById("badge");
      const notificationList = document.getElementById("notificationList");
      const clearAllBtn = document.getElementById("clearAll");
      let notificationCount = 3;

      // Bell click event (open dropdown)
      document.getElementById("bell").addEventListener("click", () => {
        if (notificationCount === 0) {
          badge.textContent = 0;
        }
      });

      // Clear all button click
      clearAllBtn.addEventListener("click", () => {
        notificationList.innerHTML = `
        <li class="notification-header">Notifications</li>
        <li class="no-notifications">No new notifications</li>
        <li><button id="clearAll" class="clear-all-btn" disabled>Clear All</button></li>
      `;
        notificationCount = 0;
        badge.textContent = notificationCount;
      });
    </script>

    <script>
      /***************
       Core in-memory data (unchanged)
      ***************/
      let categories = [];
      let toolsByCategory = {};
      let detailsByTool = {};
      let currentCategory = null;
      let editingToolIndex = null;

      /***************
       Utility functions
      ***************/
      function escapeHtml(s) {
        if (!s) return "";
        return String(s)
          .replaceAll("&", "&amp;")
          .replaceAll("<", "&lt;")
          .replaceAll(">", "&gt;");
      }
      function escapeAttr(s) {
        return (s || "").replaceAll('"', "&quot;");
      }

      /***************
       Step helpers (flow)
      ***************/
      function showStep(n) {
        document.querySelectorAll(".step-section").forEach((s, i) => {
          s.style.display = i === n - 1 ? "" : "none";
        });
        document.getElementById("currentStep").innerText = n;
        const titles = ["Manage Categories", "Manage Tools", "Tool Details"];
        document.getElementById("stepTitle").innerText = titles[n - 1];
      }
      document.getElementById("goCat").onclick = () => showStep(1);
      document.getElementById("goTools").onclick = () => {
        if (!currentCategory) return alert("Open a category first");
        showStep(2);
      };
      document.getElementById("goDetails").onclick = () =>
        alert("Open a tool from Step 2 to edit full details.");
      document
        .getElementById("backToCat")
        .addEventListener("click", () => showStep(1));
      document
        .getElementById("backToTools")
        .addEventListener("click", () => showStep(2));

      /***************
       Render categories
      ***************/
      function renderCategories() {
        const grid = document.getElementById("categoryGrid");
        grid.innerHTML = "";
        if (categories.length === 0) {
          grid.innerHTML = `<div class="col-12"><div class="alert alert-info">No categories yet. Add one using "Add Category".</div></div>`;
          return;
        }
        categories.forEach((cat) => {
          const count = (toolsByCategory[cat] || []).length;
          grid.insertAdjacentHTML(
            "beforeend",
            `
            <div class="col-md-4 mb-3">
              <div class="card p-3 category-card">
                <div class="d-flex justify-content-between align-items-start">
                  <div>
                    <h5 class="mb-1">${escapeHtml(cat)}</h5>
                    <div class="small-muted">${count} tools</div>
                  </div>
                  <div class="text-end">
                    <button class="btn btn-sm btn-outline-primary me-1" onclick="openCategory(event,'${escapeAttr(cat)}')"><i class="bi bi-box-arrow-up-right"></i></button>
                    <button class="btn btn-sm btn-outline-danger" onclick="deleteCategory(event,'${escapeAttr(cat)}')"><i class="bi bi-trash"></i></button>
                  </div>
                </div>
              </div>
            </div>
          `,
          );
        });
      }

      document.getElementById("saveCategory").addEventListener("click", () => {
        const v = document.getElementById("catInput").value.trim();
        if (!v) return alert("Enter category name");
        if (!categories.includes(v)) {
          categories.push(v);
          toolsByCategory[v] = [];
        }
        document.getElementById("catInput").value = "";
        bootstrap.Modal.getInstance(
          document.getElementById("categoryModal"),
        ).hide();
        renderCategories();
      });

      window.openCategory = function (ev, cat) {
        ev.stopPropagation();
        currentCategory = cat;
        document.getElementById("catTitle").innerText = cat;
        document.getElementById("tCategory").value = cat;
        renderTools();
        showStep(2);
      };

      window.deleteCategory = function (ev, cat) {
        ev.stopPropagation();
        if (!confirm(`Delete category "${cat}" and its tools?`)) return;
        categories = categories.filter((c) => c !== cat);
        delete toolsByCategory[cat];
        renderCategories();
        if (currentCategory === cat) {
          currentCategory = null;
          showStep(1);
        }
      };

      /***************
       Star widget utilities
       - createStarWidget(containerEl, inputEl)
       - setStarWidgetValue(containerEl, value)
       - highlightStars
      ***************/
      function createStarWidget(containerElOrId, inputElOrId) {
        const container =
          typeof containerElOrId === "string"
            ? document.getElementById(containerElOrId)
            : containerElOrId;
        const input =
          typeof inputElOrId === "string"
            ? document.getElementById(inputElOrId)
            : inputElOrId;
        if (!container || !input) return;
        container.innerHTML = "";
        for (let i = 1; i <= 5; i++) {
          const star = document.createElement("i");
          star.className = "bi bi-star star";
          star.dataset.value = i;
          star.title = i + " star";
          star.addEventListener("mouseenter", () =>
            highlightStars(container, i),
          );
          star.addEventListener("mouseleave", () =>
            highlightStars(container, Number(input.value) || 0),
          );
          star.addEventListener("click", () => {
            input.value = i;
            highlightStars(container, i);
          });
          container.appendChild(star);
        }
        // initial highlight
        highlightStars(container, Number(input.value) || 0);
      }
      function highlightStars(container, count) {
        if (typeof container === "string")
          container = document.getElementById(container);
        if (!container) return;
        container.querySelectorAll(".star").forEach((st) => {
          const v = Number(st.dataset.value);
          if (v <= count) {
            st.classList.remove("bi-star");
            st.classList.add("bi-star-fill");
            st.classList.add("filled");
            st.style.color = "#FFD700";
          } else {
            st.classList.remove("bi-star-fill");
            st.classList.add("bi-star");
            st.classList.remove("filled");
            st.style.color = "#ccc";
          }
        });
      }
      function setStarWidgetValue(containerId, value) {
        const container = document.getElementById(containerId);
        if (!container) return;
        // find related input by convention: containerId 'dRatingStars' => input id 'dRating'
        const inputId = containerId.replace(/Stars$/, "");
        const input = document.getElementById(inputId);
        if (input) input.value = value;
        highlightStars(container, Number(value) || 0);
      }

      /***************
       Render tools table (Step 2)
      ***************/
      function linkOrDash(url) {
        if (!url) return "-";
        const short = url.length > 30 ? url.slice(0, 28) + "..." : url;
        return `<a href="${escapeAttr(url)}" target="_blank" rel="noreferrer" class="small-link">${escapeHtml(short)}</a>`;
      }

      function renderTools() {
        const tbody = document.getElementById("toolsTable");
        tbody.innerHTML = "";
        const arr = toolsByCategory[currentCategory] || [];
        if (arr.length === 0) {
          tbody.innerHTML =
            '<tr><td colspan="12" class="text-center text-muted">No tools yet. Add using "Add Tool".</td></tr>';
          return;
        }
        arr.forEach((t, i) => {
          // rating stars display (readonly)
          const rating = Number(t.rating) || 0;
          let starsHTML = "";
          for (let s = 1; s <= 5; s++) {
            starsHTML += `<i class="${s <= rating ? "bi bi-star-fill" : "bi bi-star"}" style="color:${s <= rating ? "#FFD700" : "#ddd"}; margin-right:3px;"></i>`;
          }
          tbody.insertAdjacentHTML(
            "beforeend",
            `
            <tr>
              <td>${i + 1}</td>
              <td>${t.image ? `<img src="${escapeAttr(t.image)}" class="img-thumb">` : "-"}</td>
              <td>${escapeHtml(t.name)}</td>
              <td>${escapeHtml(t.category)}</td>
              <td>${escapeHtml(t.pricing)}</td>
              <td>${escapeHtml(t.platform)}</td>
              <td>${linkOrDash(t.website)}</td>
              <td>${linkOrDash(t.youtube)}</td>
              <td>${linkOrDash(t.instagram)}</td>
              <td>${linkOrDash(t.facebook)}</td>
              <td>${starsHTML}</td>
              <td>
                <button class="btn btn-sm btn-outline-primary me-1" onclick="openDetailByIndex(${i})" title="Details"><i class="bi bi-plus-lg"></i></button>
                <button class="btn btn-sm btn-outline-secondary me-1" onclick="quickEdit(${i})" title="Quick Edit"><i class="bi bi-pencil-square"></i></button>
                <button class="btn btn-sm btn-outline-danger" onclick="deleteTool(${i})" title="Delete"><i class="bi bi-trash"></i></button>
              </td>
            </tr>
          `,
          );
        });
        // After rendering tools, rebuild datalists for compare rows
        rebuildCompareDatalists();
      }

      /***************
       Tool modal save / quick edit (Step 2)
      ***************/
      document.getElementById("saveTool").addEventListener("click", () => {
        const obj = {
          name: document.getElementById("tName").value.trim(),
          category: document.getElementById("tCategory").value,
          pricing: document.getElementById("tPricing").value,
          platform: document.getElementById("tPlatform").value.trim(),
          rating: document.getElementById("tRating").value || "0",
          website: document.getElementById("tWebsite").value.trim(),
          youtube: document.getElementById("tYouTube").value.trim(),
          instagram: document.getElementById("tInsta").value.trim(),
          facebook: document.getElementById("tFacebook").value.trim(),
          image: document.getElementById("tImagePreview")
            ? document.getElementById("tImagePreview").src
            : "",
        };
        if (!obj.name) return alert("Tool name required");
        if (!currentCategory) return alert("Open a category first");
        // if editingToolIndex not null then update else push
        if (editingToolIndex !== null) {
          toolsByCategory[currentCategory][editingToolIndex] = obj;
          editingToolIndex = null;
        } else {
          toolsByCategory[currentCategory].push(obj);
        }
        bootstrap.Modal.getInstance(
          document.getElementById("toolModal"),
        ).hide();
        document.getElementById("toolForm").reset();
        // reset star widget
        setStarWidgetValue("tRatingStars", 0);
        if (document.getElementById("tImagePreview")) {
          document.getElementById("tImagePreview").style.display = "none";
          document.getElementById("tImagePreview").src = "";
        }
        renderTools();
      });

      window.quickEdit = function (index) {
        const arr = toolsByCategory[currentCategory];
        if (!arr || !arr[index]) return;
        const t = arr[index];
        editingToolIndex = index;
        document.getElementById("tName").value = t.name;
        document.getElementById("tCategory").value = t.category;
        document.getElementById("tPricing").value = t.pricing;
        document.getElementById("tPlatform").value = t.platform;
        document.getElementById("tWebsite").value = t.website;
        document.getElementById("tYouTube").value = t.youtube;
        document.getElementById("tInsta").value = t.instagram;
        document.getElementById("tFacebook").value = t.facebook;
        document.getElementById("tRating").value = t.rating || 0;
        setStarWidgetValue("tRatingStars", Number(t.rating) || 0);
        // image preview
        if (t.image) {
          let imgPrev = document.getElementById("tImagePreview");
          if (!imgPrev) {
            const div = document.createElement("div");
            div.className = "mt-2 text-center";
            imgPrev = document.createElement("img");
            imgPrev.id = "tImagePreview";
            imgPrev.style.maxWidth = "100px";
            imgPrev.style.borderRadius = "6px";
            div.appendChild(imgPrev);
            document.querySelector("#toolForm").appendChild(div);
          }
          imgPrev.src = t.image;
          imgPrev.style.display = "block";
        }
        new bootstrap.Modal(document.getElementById("toolModal")).show();
      };

      function deleteTool(i) {
        if (!confirm("Delete tool?")) return;
        toolsByCategory[currentCategory].splice(i, 1);
        renderTools();
      }

      function openDetailByIndex(i) {
        const tool = (toolsByCategory[currentCategory] || [])[i];
        if (!tool) return;
        openDetail(tool.name);
      }

      /***************
       Open full detail (Step 3)
      ***************/
      function openDetail(toolName) {
        const tool =
          (toolsByCategory[currentCategory] || []).find(
            (t) => t.name === toolName,
          ) || {};
        document.getElementById("dName").value = tool.name || toolName;
        document.getElementById("dCategory").value =
          tool.category || currentCategory || "";
        document.getElementById("dPricing").value = tool.pricing || "";
        // main rating
        document.getElementById("dRating").value = Number(tool.rating) || 0;
        setStarWidgetValue("dRatingStars", Number(tool.rating) || 0);

        // fill attributes & details if present in detailsByTool
        const d = detailsByTool[tool.name] || {};
        // document.getElementById("attrPlatform").value =
        //   d.attributes?.platform || tool.platform || "Web";
        // document.getElementById("attrApi").value = d.attributes?.api || "";
        // document.getElementById("attrBestFor").value =
        //   d.attributes?.bestFor || "";
        // document.getElementById("attrImageGen").value =
        //   d.attributes?.imageGen || "";

        document.getElementById("dFeatures").value = (d.features || []).join(
          ", ",
        );
        document.getElementById("dAnalysis").value = d.analysis || "";
        document.getElementById("dPros").value = (d.pros || []).join("\n");
        document.getElementById("dCons").value = (d.cons || []).join("\n");

        renderFaqs(d.faqs || []);
        renderRelated(d.related || []);

        // render compare rows stored or empty
        renderCompareRows(d.compare || []);

        showStep(3);
      }

      /***************
       Compare rows management
      ***************/
      let compareRowCounter = 0;
      function renderCompareRows(rows) {
        const container = document.getElementById("compareContainer");
        container.innerHTML = "";
        if (!rows || rows.length === 0) {
          container.innerHTML =
            '<div class="small-muted">No comparison tools added yet.</div>';
          return;
        }
        rows.forEach((prefill) => addCompareRow(prefill));
      }

      function addCompareRow(prefill) {
        compareRowCounter++;
        const id = compareRowCounter;
        const container = document.getElementById("compareContainer");
        const div = document.createElement("div");
        div.className = "compare-row";
        div.id = "compareRow_" + id;

        div.innerHTML = `
          <div class="d-flex justify-content-between align-items-start mb-2">
            <strong>Compare Tool</strong>
            <button class="btn btn-sm btn-outline-danger" type="button" onclick="removeCompareRow(${id})"><i class="bi bi-x"></i></button>
          </div>
          <div class="row g-2">
            <div class="col-md-3">
              <label class="form-label">Tool Name</label>
              <input list="toolsList_${id}" class="form-control compare-tool-name" id="compare_tool_${id}" placeholder="Type or select..." />
              <datalist id="toolsList_${id}"></datalist>
            </div>
            <div class="col-md-2">
              <label class="form-label">Plan</label>
              <select id="compare_plan_${id}" class="form-select">
                <option>Free</option><option>Paid</option><option>Free+Paid</option>
              </select>
            </div>
            <div class="col-md-2">
              <label class="form-label">AI Quality</label>
              <input type="hidden" id="compare_aiQuality_input_${id}" value="0" />
              <div id="compare_aiQuality_${id}" class="star-widget"></div>
            </div>
            <div class="col-md-2">
              <label class="form-label">Accuracy</label>
              <select id="compare_model_${id}" class="form-select">
                <option>Best</option><option>Average</option>
              </select>
            </div>
            <div class="col-md-3">
              <label class="form-label">AI Model Type</label>
              <select id="compare_model_${id}" class="form-select">
                <option>gpt-4o</option><option>gpt-4</option><option>gpt-3.5</option><option>custom</option>
              </select>
            </div>

            

            <div class="col-md-2 mt-2">
              <label class="form-label">Customization</label>
              <select id="compare_speed_${id}" class="form-select mt-1"><option>Yes</option><option>No</option></select>
            </div>

            <div class="col-md-2 mt-2">
              <label class="form-label">Brand Voice Support</label>
              <select id="compare_speed_${id}" class="form-select mt-1"><option>Yes</option><option>No</option></select>
            </div>

            <div class="col-md-2 mt-2">
              <label class="form-label">API Access</label>
              <select id="compare_api_${id}" class="form-select mt-1"><option>Yes</option><option>No</option></select>
            </div>

            <div class="col-md-2 mt-2">
              <label class="form-label">Image Generation</label>
              <select id="compare_api_${id}" class="form-select mt-1"><option>Yes</option><option>No</option></select>
            </div>

            <div class="col-md-2 mt-2">
              <label class="form-label">Team Collaboration</label>
              <select id="compare_team_${id}" class="form-select mt-1"><option>Yes</option><option>No</option></select>
            </div>
            <div class="col-md-4 mt-2">
              <label class="form-label">Best For</label>
              <select id="compare_bestfor_${id}" class="form-select mt-1"><option>Creators</option><option>Designers</option><option>Developers</option></select>
            </div>
          </div>
        `;
        container.appendChild(div);

        // populate datalist with current category tools
        const datalist = document.getElementById("toolsList_" + id);
        datalist.innerHTML = "";
        const allTools = (toolsByCategory[currentCategory] || []).map(
          (t) => t.name,
        );
        allTools.forEach((name) => {
          const opt = document.createElement("option");
          opt.value = name;
          datalist.appendChild(opt);
        });

        // create star widgets for the two star fields
        createStarWidget(
          "compare_aiQuality_" + id,
          "compare_aiQuality_input_" + id,
        );
        createStarWidget(
          "compare_accuracy_" + id,
          "compare_accuracy_input_" + id,
        );

        // if prefill provided, set values
        if (prefill) {
          document.getElementById("compare_tool_" + id).value =
            prefill.toolName || "";
          document.getElementById("compare_plan_" + id).value =
            prefill.plan || "Free";
          setStarWidgetValue("compare_aiQuality_" + id, prefill.aiQuality || 0);
          setStarWidgetValue("compare_accuracy_" + id, prefill.accuracy || 0);
          document.getElementById("compare_model_" + id).value =
            prefill.modelType || "gpt-4o";
          document.getElementById("compare_speed_" + id).value =
            prefill.speed || "Fast";
          document.getElementById("compare_api_" + id).value =
            prefill.apiAccess || "Yes";
          document.getElementById("compare_team_" + id).value =
            prefill.teamCollab || "Yes";
          document.getElementById("compare_bestfor_" + id).value =
            prefill.bestFor || "Creators";
        }
      }

      function removeCompareRow(id) {
        const el = document.getElementById("compareRow_" + id);
        if (el) el.remove();
      }

      document
        .getElementById("addCompareBtn")
        .addEventListener("click", (e) => {
          e.preventDefault();
          addCompareRow();
        });

      // rebuild datalists for compare rows after tools change
      function rebuildCompareDatalists() {
        const allTools = (toolsByCategory[currentCategory] || []).map(
          (t) => t.name,
        );
        document.querySelectorAll("[id^='compareRow_']").forEach((row) => {
          const id = row.id.replace("compareRow_", "");
          const datalist = document.getElementById("toolsList_" + id);
          if (datalist) {
            datalist.innerHTML = allTools
              .map((n) => `<option value="${escapeHtml(n)}"></option>`)
              .join("");
          }
        });
      }

      /***************
       Related tools autosuggest
      ***************/
      const relatedInput = document.getElementById("relatedInput");
      const relatedSuggestions = document.getElementById("relatedSuggestions");

      relatedInput.addEventListener("input", () => {
        const q = relatedInput.value.trim().toLowerCase();
        if (!q) {
          relatedSuggestions.style.display = "none";
          relatedSuggestions.innerHTML = "";
          return;
        }
        const candidates = (toolsByCategory[currentCategory] || [])
          .map((t) => t.name)
          .filter((n) => n.toLowerCase().includes(q));
        if (candidates.length === 0) {
          relatedSuggestions.style.display = "none";
          relatedSuggestions.innerHTML = "";
          return;
        }
        relatedSuggestions.innerHTML = candidates
          .map(
            (c) =>
              `<li onclick="selectRelated('${escapeAttr(c)}')">${escapeHtml(c)}</li>`,
          )
          .join("");
        relatedSuggestions.style.display = "block";
      });

      function selectRelated(name) {
        relatedSuggestions.style.display = "none";
        relatedInput.value = name;
      }

      document
        .getElementById("addRelatedBtn")
        .addEventListener("click", (e) => {
          e.preventDefault();
          const v = relatedInput.value.trim();
          if (!v) return alert("Enter or select a related tool");
          const list = document.getElementById("relatedList");
          const exists = Array.from(list.children).some(
            (li) => li.firstChild.textContent.trim() === v,
          );
          if (!exists) {
            const li = document.createElement("li");
            li.className = "list-group-item d-flex justify-content-between";
            li.innerHTML = `${escapeHtml(v)}<button class="btn btn-sm btn-outline-danger" onclick="removeRelatedItem(this)"><i class="bi bi-x"></i></button>`;
            list.appendChild(li);
          }
          relatedInput.value = "";
        });
      function removeRelatedItem(btn) {
        btn.closest("li").remove();
      }

      /***************
       FAQs
      ***************/
      function renderFaqs(list) {
        const el = document.getElementById("faqList");
        el.innerHTML = "";
        (list || []).forEach((f, i) => {
          el.insertAdjacentHTML(
            "beforeend",
            `<li class="list-group-item d-flex justify-content-between align-items-start"><div><strong>Q:</strong> ${escapeHtml(f.q)}<br><small><strong>A:</strong> ${escapeHtml(f.a)}</small></div><button class="btn btn-sm btn-outline-danger" onclick="removeFaq(${i})"><i class="bi bi-x"></i></button></li>`,
          );
        });
      }
      function getFaqsFromUI() {
        const arr = [];
        document.querySelectorAll("#faqList li").forEach((li) => {
          const txt = li.querySelector("div").innerText;
          const parts = txt.split("A:");
          arr.push({
            q: parts[0].replace("Q:", "").trim(),
            a: parts[1]?.trim(),
          });
        });
        return arr;
      }
      window.removeFaq = function (i) {
        const arr = getFaqsFromUI();
        arr.splice(i, 1);
        renderFaqs(arr);
      };
      document.getElementById("addFaqBtn").addEventListener("click", (e) => {
        e.preventDefault();
        const q = document.getElementById("faqQ").value.trim();
        const a = document.getElementById("faqA").value.trim();
        if (!q || !a) return alert("Enter both Q and A");
        const cur = getFaqsFromUI();
        cur.push({ q, a });
        renderFaqs(cur);
        document.getElementById("faqQ").value = "";
        document.getElementById("faqA").value = "";
      });

      /***************
       Render related list (used when loading details)
      ***************/
      function renderRelated(list) {
        const el = document.getElementById("relatedList");
        el.innerHTML = "";
        (list || []).forEach((r, i) =>
          el.insertAdjacentHTML(
            "beforeend",
            `<li class="list-group-item d-flex justify-content-between">${escapeHtml(r)}<button class="btn btn-sm btn-outline-danger" onclick="removeRelated(${i})"><i class="bi bi-x"></i></button></li>`,
          ),
        );
      }
      function getRelatedFromUI() {
        const arr = [];
        document
          .querySelectorAll("#relatedList li")
          .forEach((li) => arr.push(li.firstChild.textContent.trim()));
        return arr;
      }
      window.removeRelated = function (i) {
        const arr = getRelatedFromUI();
        arr.splice(i, 1);
        renderRelated(arr);
      };

      /***************
       Save Details (Step 3)
      ***************/
      document
        .getElementById("saveDetailsBtn")
        .addEventListener("click", () => {
          const name = document.getElementById("dName").value.trim();
          if (!name) return alert("Tool name required");
          // collect compare rows
          const compareRows = [];
          document.querySelectorAll("[id^='compareRow_']").forEach((row) => {
            const id = row.id.replace("compareRow_", "");
            const toolName = document
              .getElementById("compare_tool_" + id)
              .value.trim();
            if (!toolName) return; // skip empty rows
            compareRows.push({
              toolName,
              plan: document.getElementById("compare_plan_" + id).value,
              aiQuality:
                Number(
                  document.getElementById("compare_aiQuality_input_" + id)
                    .value,
                ) || 0,
              accuracy:
                Number(
                  document.getElementById("compare_accuracy_input_" + id).value,
                ) || 0,
              modelType: document.getElementById("compare_model_" + id).value,
              speed: document.getElementById("compare_speed_" + id).value,
              apiAccess: document.getElementById("compare_api_" + id).value,
              teamCollab: document.getElementById("compare_team_" + id).value,
              bestFor: document.getElementById("compare_bestfor_" + id).value,
            });
          });

          detailsByTool[name] = {
            tag: document.getElementById("dTag").value.trim(),
            rating: Number(document.getElementById("dRating").value) || 0,
            category: document.getElementById("dCategory").value,
            pricing: document.getElementById("dPricing").value,
            
            features: document
              .getElementById("dFeatures")
              .value.split(/\r?\n|,/)
              .map((s) => s.trim())
              .filter(Boolean),
            analysis: document.getElementById("dAnalysis").value.trim(),
            pros: document
              .getElementById("dPros")
              .value.split(/\r?\n/)
              .map((s) => s.trim())
              .filter(Boolean),
            cons: document
              .getElementById("dCons")
              .value.split(/\r?\n/)
              .map((s) => s.trim())
              .filter(Boolean),
            faqs: getFaqsFromUI(),
            related: getRelatedFromUI(),
            compare: compareRows,
          };
          alert("Details saved in session memory for: " + name);
          showStep(2);
          renderTools();
        });

      /***************
       Init: create star widgets and demo data
      ***************/
      document.addEventListener("DOMContentLoaded", () => {
        // create star widgets for dRating and tRating
        createStarWidget("dRatingStars", "dRating");
        createStarWidget("tRatingStars", "tRating");

        // sample demo data if empty
        if (categories.length === 0) {
          categories.push("Web Development");
          toolsByCategory["Web Development"] = [
            {
              name: "ExampleTool",
              category: "Web Development",
              pricing: "Free",
              platform: "Web",
              rating: "4",
              website: "https://example.com",
              youtube: "",
              instagram: "",
              facebook: "",
              image: "",
            },
          ];
        }
        renderCategories();
      });

      /***************
       Sidebar toggle + simple notification handling
      ***************/
      try {
        const toggleBtn = document.querySelector(".sidebar-toggle-btn");
        const sidebar = document.querySelector(".sidebar");
        toggleBtn.addEventListener("click", () => {
          if (window.innerWidth < 992) sidebar.classList.toggle("show");
          else sidebar.classList.toggle("collapsed");
        });
      } catch (e) {
        /* ignore */
      }

      // simple bell clear
      document.getElementById("bell").addEventListener("click", () => {
        const b = document.getElementById("badge");
        if (b) b.style.display = "none";
      });

      /***************
       Rebuild compare datalists when tools are changed globally
      ***************/
      (function patchRenderTools() {
        const orig = renderTools;
        renderTools = function () {
          orig();
          rebuildCompareDatalists();
        };
      })();

      /***************
       Optional: image upload preview helper (if you add file input later)
      ***************/
      // If you'll add input type=file with id 'tImageUpload', this will show preview in modal using id 'tImagePreview'
      const tImageUpload = document.getElementById("tImageUpload");
      if (tImageUpload) {
        tImageUpload.addEventListener("change", (e) => {
          const f = e.target.files[0];
          if (!f) return;
          const r = new FileReader();
          r.onload = (ev) => {
            let imgPrev = document.getElementById("tImagePreview");
            if (!imgPrev) {
              const div = document.createElement("div");
              div.className = "mt-2 text-center";
              imgPrev = document.createElement("img");
              imgPrev.id = "tImagePreview";
              imgPrev.style.maxWidth = "100px";
              imgPrev.style.borderRadius = "6px";
              div.appendChild(imgPrev);
              document.querySelector("#toolForm").appendChild(div);
            }
            imgPrev.src = ev.target.result;
            imgPrev.style.display = "block";
          };
          r.readAsDataURL(f);
        });
      }
    </script>

    <script>
/***************
 âœ… Dynamic Dropdown Attributes System
***************/
function renderAttributes(list = []) {
  const container = document.getElementById("attrContainer");
  container.innerHTML = "";
  if (!list || list.length === 0) {
    container.innerHTML =
      '<div class="small-muted">No attributes added yet.</div>';
    return;
  }
  list.forEach((attr) => addAttributeRow(attr.name, attr.value));
}

function addAttributeRow(name = "", value = "") {
  const container = document.getElementById("attrContainer");
  const div = document.createElement("div");
  div.className = "col-md-6 attr-row";
  div.innerHTML = `
    <div class="d-flex align-items-center gap-2">
      <input type="text" class="form-control attr-name" placeholder="Attribute Name" value="${name}">
      <select class="form-select attr-value">
        <option value="">-- Select Value --</option>
        <option value="Yes" ${value==="Yes"?"selected":""}>Yes</option>
        <option value="No" ${value==="No"?"selected":""}>No</option>
        
      </select>
      <button class="btn btn-outline-danger btn-sm" type="button" onclick="this.closest('.attr-row').remove()">
        <i class="bi bi-x"></i>
      </button>
    </div>
  `;
  container.appendChild(div);
}

document.getElementById("addAttrBtn").addEventListener("click", (e) => {
  e.preventDefault();
  addAttributeRow();
});

function getAttributesFromUI() {
  const attrs = [];
  document.querySelectorAll(".attr-row").forEach((row) => {
    const name = row.querySelector(".attr-name").value.trim();
    const value = row.querySelector(".attr-value").value.trim();
    if (name && value) attrs.push({ name, value });
  });
  return attrs;
}

/***************
 ðŸ” Hook into Save Details (existing code)
***************/
const oldSaveHandler = document.getElementById("saveDetailsBtn").onclick;
document.getElementById("saveDetailsBtn").onclick = () => {
  if (typeof oldSaveHandler === "function") oldSaveHandler();
  if (typeof detailsByTool === "object") {
    const name = document.getElementById("dName").value.trim();
    if (name && detailsByTool[name]) {
      detailsByTool[name].attributes = getAttributesFromUI();
    }
  }
};
</script>
  </body>
</html>
